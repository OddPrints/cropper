/*!
 * Cropper v2.3.4
 * https://github.com/OddPrints/cropper forked from https://github.com/fengyuanchen/cropper
 *
 * Copyright (c) 2015-2016 OddPrints and contributors originally 2014-2016 Fengyuan Chen and contributors
 * Released under the MIT license
 *
 * Date: 2016-07-14T09:49:51.008Z
 */
!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t("object"==typeof exports?require("jquery"):jQuery)}(function(t){"use strict";function i(t){return"number"==typeof t&&!isNaN(t)}function e(t){return"undefined"==typeof t}function s(t,e){var s=[];return i(e)&&s.push(e),s.slice.apply(t,s)}function o(t,i){var e=s(arguments,2);return function(){return t.apply(i,e.concat(s(arguments)))}}function h(t){var i=t.match(/^(https?:)\/\/([^\:\/\?#]+):?(\d*)/i);return i&&(i[1]!==T.protocol||i[2]!==T.hostname||i[3]!==T.port)}function a(t){var i="timestamp="+(new Date).getTime();return t+(t.indexOf("?")===-1?"?":"&")+i}function n(t){return t?' crossOrigin="'+t+'"':""}function r(t,i){var e;return t.naturalWidth&&!Mt?i(t.naturalWidth,t.naturalHeight):(e=document.createElement("img"),e.onload=function(){i(this.width,this.height)},void(e.src=t.src))}function p(t){var e=[],s=t.rotate,o=t.scaleX,h=t.scaleY;return i(o)&&i(h)&&e.push("scale("+o+","+h+")"),i(s)&&e.push("rotate("+s+"deg)"),e.length?e.join(" "):"none"}function l(t,i){var e,s,o=Wt(t.degree)%180,h=(o>90?180-o:o)*Math.PI/180,a=kt(h),n=Rt(h),r=t.width,p=t.height,l=t.aspectRatio;return i?(e=r/(n+a/l),s=e/l):(e=r*n+p*a,s=r*a+p*n),{width:e,height:s}}function c(e,s,o){var h,a=t("<canvas>")[0],n=a.getContext("2d"),r=0,p=0,c=s.naturalWidth,d=s.naturalHeight,g=s.rotate,f=s.scaleX,u=s.scaleY,m=i(f)&&i(u)&&(1!==f||1!==u),v=i(g)&&0!==g,w=v||m,x=c*Wt(f||1),C=d*Wt(u||1),b=0,B=0,y=2796;m&&(b=x/2,B=C/2),v&&(h=l({width:x,height:C,degree:g}),x=h.width,C=h.height,b=x/2,B=C/2);var D=1;return Yt(o.width,o.height)>y?(D=Yt(o.width,o.height)/y,x=o.width/=D,C=o.height/=D,b/=D,B/=D,c/=D,d/=D,r/=D,p/=D):(x=o.width,C=o.height),a.width=x,a.height=C,b-=o.x/=D,B-=o.y/=D,w?(r=-c/2,p=-d/2,n.save(),n.translate(b,B)):(r-=o.x,p-=o.y),m&&n.scale(f,u),v&&n.rotate(g*Math.PI/180),n.drawImage(e,Ot(r),Ot(p),Ot(c),Ot(d)),w&&n.restore(),a}function d(i){var e=i.length,s=0,o=0;return e&&(t.each(i,function(t,i){s+=i.pageX,o+=i.pageY}),s/=e,o/=e),{pageX:s,pageY:o}}function g(t,i,e){var s,o="";for(s=i,e+=i;s<e;s++)o+=Pt(t.getUint8(s));return o}function f(t){var i,e,s,o,h,a,n,r,p,l,c=new k(t),d=c.byteLength;if(255===c.getUint8(0)&&216===c.getUint8(1))for(p=2;p<d;){if(255===c.getUint8(p)&&225===c.getUint8(p+1)){n=p;break}p++}if(n&&(e=n+4,s=n+10,"Exif"===g(c,e,4)&&(a=c.getUint16(s),h=18761===a,(h||19789===a)&&42===c.getUint16(s+2,h)&&(o=c.getUint32(s+4,h),o>=8&&(r=s+o)))),r)for(d=c.getUint16(r,h),l=0;l<d;l++)if(p=r+12*l+2,274===c.getUint16(p,h)){p+=8,i=c.getUint16(p,h),Mt&&c.setUint16(p,1,h);break}return i}function u(t){var i,e=t.replace(pt,""),s=atob(e),o=s.length,h=new Y(o),a=new W(h);for(i=0;i<o;i++)a[i]=s.charCodeAt(i);return h}function m(t){var i,e=new W(t),s=e.length,o="";for(i=0;i<s;i++)o+=Pt(e[i]);return"data:image/jpeg;base64,"+R(o)}function v(t,i){return{x:i.x-t.x,y:i.y-t.y}}function w(t,i){return t.x*i.x+t.y*i.y}function x(t,i){var e=v(i.A,i.B),s=v(i.A,t),o=v(i.B,i.C),h=v(i.B,t),a=w(e,s),n=w(e,e),r=w(o,h),p=w(o,o);return 0<=a&&a<=n&&0<=r&&r<=p}function C(t,i,e){var s=zt(Rt(e)*(i.x-t.x)-kt(e)*(i.y-t.y)+t.x),o=zt(kt(e)*(i.x-t.x)+Rt(e)*(i.y-t.y)+t.y);return{x:s,y:o}}function b(t,i,e){var s={x:i.left+e.left+e.width/2,y:i.top+e.top+e.height/2},o=(e.rotate?e.rotate:0)*Math.PI/180,h={A:C(s,{x:i.left+e.left,y:i.top+e.top},o),B:C(s,{x:i.left+e.left+e.width,y:i.top+e.top},o),C:C(s,{x:i.left+e.left+e.width,y:i.top+e.top+e.height},o),D:C(s,{x:i.left+e.left,y:i.top+e.top+e.height},o)},a={A:{x:zt(t.left),y:zt(t.top)},B:{x:zt(t.left+t.width),y:zt(t.top)},C:{x:zt(t.left+t.width),y:zt(t.top+t.height)},D:{x:zt(t.left),y:zt(t.top+t.height)}};return x(a.A,h)&&x(a.B,h)&&x(a.C,h)&&x(a.D,h)}function B(t,i){var e=Xt(t.width,t.height),s=Ht(It(e,2)/2),o={};return o=i<1?{height:s,width:s*i}:{width:s,height:s/i}}function y(t,i,e,s){for(var o=t.width-2*e,h=t.height-2*e,a=0,n=!0,r=0;a<o&&(a+=n?i.width:i.width+s,!(a>o));)n=!1,r++;var p=0;n=!0;for(var l=0;p<h&&(p+=n?i.height:i.height+s,!(p>h));)n=!1,l++;return{horizontal:r,vertical:l,total:r*l}}function D(t,i,e,s){var o=y(t,i,e,s),h=o,a={width:t.height,height:t.width},n=y(a,i,e,s);return n.total>o.total&&(h=n,h.canvasRotated=!0),h}function $(i,e){this.$element=t(i),this.options=t.extend({},$.DEFAULTS,t.isPlainObject(e)&&e),this.isLoaded=!1,this.isBuilt=!1,this.isCompleted=!1,this.isRotated=!1,this.isCropped=!1,this.isDisabled=!1,this.isReplaced=!1,this.isLimited=!1,this.wheeling=!1,this.isImg=!1,this.originalUrl="",this.canvas=null,this.cropBox=null,this.init()}var L=t(window),M=t(document),T=window.location,X=window.navigator,Y=window.ArrayBuffer,W=window.Uint8Array,k=window.DataView,R=window.btoa,H="cropper",z=233,O=.15748031480000002,I=.039370078700000005,P="cropper-modal",E="cropper-hide",U="cropper-hidden",A="cropper-invisible",F="cropper-move",j="cropper-crop",S="cropper-disabled",N="cropper-bg",_="mousedown touchstart pointerdown MSPointerDown",q="mousemove touchmove pointermove MSPointerMove",K="mouseup touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel",Z="wheel mousewheel DOMMouseScroll",Q="dblclick",V="load."+H,G="error."+H,J="resize."+H,tt="build."+H,it="built."+H,et="cropstart."+H,st="cropmove."+H,ot="cropend."+H,ht="crop."+H,at="zoom."+H,nt=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,rt=/^data:/,pt=/^data:([^;]+);base64,/,lt=/^data:image\/jpeg.*;base64,/,ct="preview",dt="action",gt="e",ft="w",ut="s",mt="n",vt="se",wt="sw",xt="ne",Ct="nw",bt="all",Bt="crop",yt="move",Dt="zoom",$t="none",Lt=t.isFunction(t("<canvas>")[0].getContext),Mt=X&&/(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i.test(X.userAgent),Tt=Number,Xt=Math.min,Yt=Math.max,Wt=Math.abs,kt=Math.sin,Rt=Math.cos,Ht=Math.sqrt,zt=Math.round,Ot=Math.floor,It=Math.pow,Pt=String.fromCharCode;$.prototype={constructor:$,init:function(){var t,i=this.$element;if(i.is("img")){if(this.isImg=!0,this.originalUrl=t=i.attr("src"),!t)return;t=i.prop("src")}else i.is("canvas")&&Lt&&(t=i[0].toDataURL());this.load(t)},trigger:function(i,e){var s=t.Event(i,e);return this.$element.trigger(s),s},load:function(i){var e,s,o=this.options,n=this.$element;if(i&&(n.one(tt,o.build),!this.trigger(tt).isDefaultPrevented())){if(this.url=i,this.image={},!o.checkOrientation||!Y)return this.clone();if(e=t.proxy(this.read,this),rt.test(i))return lt.test(i)?e(u(i)):this.clone();s=new XMLHttpRequest,s.onerror=s.onabort=t.proxy(function(){this.clone()},this),s.onload=function(){e(this.response)},o.checkCrossOrigin&&h(i)&&n.prop("crossOrigin")&&(i=a(i)),s.open("get",i),s.responseType="arraybuffer",s.send()}},read:function(t){var i,e,s,o=this.options,h=f(t),a=this.image;if(h>1)switch(this.url=m(t),h){case 2:e=-1;break;case 3:i=-180;break;case 4:s=-1;break;case 5:i=90,s=-1;break;case 6:i=90;break;case 7:i=90,e=-1;break;case 8:i=-90}o.rotatable&&(a.rotate=i),o.scalable&&(a.scaleX=e,a.scaleY=s),this.clone()},clone:function(){var i,e,s=this.options,o=this.$element,r=this.url,p="";s.checkCrossOrigin&&h(r)&&(p=o.prop("crossOrigin"),p?i=r:(p="anonymous",i=a(r))),this.crossOrigin=p,this.crossOriginUrl=i,this.$clone=e=t("<img"+n(p)+' src="'+(i||r)+'">'),this.isImg?o[0].complete?this.start():o.one(V,t.proxy(this.start,this)):e.one(V,t.proxy(this.start,this)).one(G,t.proxy(this.stop,this)).addClass(E).insertAfter(o)},start:function(){var i=this.$element,e=this.$clone;this.isImg||(e.off(G,this.stop),i=e),r(i[0],t.proxy(function(i,e){t.extend(this.image,{naturalWidth:i,naturalHeight:e,aspectRatio:i/e}),this.isLoaded=!0,this.build()},this))},stop:function(){this.$clone.remove(),this.$clone=null},build:function(){var i,e,s,o=this.options,h=this.$element,a=this.$clone;this.isLoaded&&(this.isBuilt&&this.unbuild(),this.$container=h.parent(),this.$cropper=i=t($.TEMPLATE),this.$canvas=i.find(".cropper-canvas").append(a),this.$dragBox=i.find(".cropper-drag-box"),this.$cropBox=e=i.find(".cropper-crop-box"),this.$viewBox=i.find(".cropper-view-box"),this.$face=s=e.find(".cropper-face"),h.addClass(U).after(i),this.isImg||a.removeClass(E),this.initPreview(),this.bind(),o.aspectRatio=Yt(0,o.aspectRatio)||NaN,o.viewMode=Yt(0,Xt(4,zt(o.viewMode)))||0,o.autoCrop?(this.isCropped=!0,o.modal&&this.$dragBox.addClass(P)):e.addClass(U),o.guides||e.find(".cropper-dashed").addClass(U),o.center||e.find(".cropper-center").addClass(U),o.cropBoxMovable&&s.addClass(F).data(dt,bt),o.highlight||s.addClass(A),o.background&&i.addClass(N),o.cropBoxResizable||e.find(".cropper-line, .cropper-point").addClass(U),this.setDragMode(o.dragMode),this.render(),this.isBuilt=!0,this.setData(o.data),h.one(it,o.built),setTimeout(t.proxy(function(){this.trigger(it),this.trigger(ht,this.getData()),this.isCompleted=!0},this),0))},unbuild:function(){this.isBuilt&&(this.isBuilt=!1,this.isCompleted=!1,this.initialImage=null,this.initialCanvas=null,this.initialCropBox=null,this.container=null,this.canvas=null,this.cropBox=null,this.unbind(),this.resetPreview(),this.$preview=null,this.$viewBox=null,this.$cropBox=null,this.$dragBox=null,this.$canvas=null,this.$container=null,this.$cropper.remove(),this.$cropper=null)},render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.isCropped&&this.renderCropBox()},initContainer:function(){var t=this.options,i=this.$element,e=this.$container,s=this.$cropper;s.addClass(U),i.removeClass(U),s.css(this.container={width:Yt(e.width(),Tt(t.minContainerWidth)||200),height:Yt(e.height(),Tt(t.minContainerHeight)||100)}),i.addClass(U),s.removeClass(U)},initCanvas:function(){var i,e=this.options.viewMode,s=this.container,o=s.width,h=s.height,a=this.image,n=a.naturalWidth,r=a.naturalHeight,p=90===Wt(a.rotate),l=p?r:n,c=p?n:r,d=l/c,g=o,f=h;h*d>o?3===e?g=h*d:f=o/d:3===e?f=o/d:g=h*d,i={naturalWidth:l,naturalHeight:c,aspectRatio:d,width:g,height:f},i.oldLeft=i.left=(o-g)/2,i.oldTop=i.top=(h-f)/2,this.canvas=i,this.isLimited=1===e||2===e||4===e,this.limitCanvas(!0,!0),this.initialImage=t.extend({},a),this.initialCanvas=t.extend({},i)},limitCanvas:function(t,i){var e,s,o,h,a=this.options,n=a.viewMode,r=this.container,p=r.width,l=r.height,c=this.canvas,d=c.aspectRatio,g=this.cropBox,f=this.isCropped&&g;t&&(e=Tt(a.minCanvasWidth)||0,s=Tt(a.minCanvasHeight)||0,n&&(n>1?(e=Yt(e,p),s=Yt(s,l),3===n&&(s*d>e?e=s*d:s=e/d)):e?e=Yt(e,f?g.width:0):s?s=Yt(s,f?g.height:0):f&&(e=g.width,s=g.height,s*d>e?e=s*d:s=e/d)),e&&s?s*d>e?s=e/d:e=s*d:e?s=e/d:s&&(e=s*d),c.minWidth=e,c.minHeight=s,c.maxWidth=1/0,c.maxHeight=1/0),i&&(n&&4!==n?(o=p-c.width,h=l-c.height,c.minLeft=Xt(0,o),c.minTop=Xt(0,h),c.maxLeft=Yt(0,o),c.maxTop=Yt(0,h),f&&this.isLimited&&(c.minLeft=Xt(g.left,g.left+g.width-c.width),c.minTop=Xt(g.top,g.top+g.height-c.height),c.maxLeft=g.left,c.maxTop=g.top,2===n&&(c.width>=p&&(c.minLeft=Xt(0,o),c.maxLeft=Yt(0,o)),c.height>=l&&(c.minTop=Xt(0,h),c.maxTop=Yt(0,h))))):(c.minLeft=-c.width,c.minTop=-c.height,c.maxLeft=p,c.maxTop=l))},renderCanvas:function(t){var i,e,s=this.options,o=this.canvas,h=this.image,a=this.container,n=this.cropBox,r=h.rotate,p=h.naturalWidth,c=h.naturalHeight;this.isRotated&&(this.isRotated=!1,e=l({width:h.width,height:h.height,degree:r}),i=e.width/e.height,i!==o.aspectRatio&&(o.left-=(e.width-o.width)/2,o.top-=(e.height-o.height)/2,o.width=e.width,o.height=e.height,o.aspectRatio=i,o.naturalWidth=p,o.naturalHeight=c,r%180&&(e=l({width:p,height:c,degree:r}),o.naturalWidth=e.width,o.naturalHeight=e.height),this.limitCanvas(!0,!1))),4===s.viewMode&&(o.aspectRatio>a.width/a.height?parseInt(o.width)!==parseInt(a.width)&&(o.width=a.width,o.height=o.width/o.aspectRatio,o.left=0,o.top=(a.height-o.height)/2):parseInt(o.height)!==parseInt(a.height)&&(o.height=a.height,o.width=o.height*o.aspectRatio,o.top=0,o.left=(a.width-o.width)/2)),(o.width>o.maxWidth||o.width<o.minWidth)&&(o.left=o.oldLeft),(o.height>o.maxHeight||o.height<o.minHeight)&&(o.top=o.oldTop),o.width=Xt(Yt(o.width,o.minWidth),o.maxWidth),o.height=Xt(Yt(o.height,o.minHeight),o.maxHeight),this.limitCanvas(!1,!0),o.oldLeft=o.left=Xt(Yt(o.left,o.minLeft),o.maxLeft),o.oldTop=o.top=Xt(Yt(o.top,o.minTop),o.maxTop),this.$canvas.css({width:o.width,height:o.height,left:o.left,top:o.top}),this.renderImage(),this.isCropped&&this.isLimited&&(this.limitCropBox(!0,!0),this.constrainCropBox(n,o,h)),t&&this.output()},renderImage:function(i){var e,s=this.canvas,o=this.image;o.rotate&&(e=l({width:s.width,height:s.height,degree:o.rotate,aspectRatio:o.aspectRatio},!0)),t.extend(o,e?{width:e.width,height:e.height,left:(s.width-e.width)/2,top:(s.height-e.height)/2}:{width:s.width,height:s.height,left:0,top:0}),this.$clone.css({width:o.width,height:o.height,marginLeft:o.left,marginTop:o.top,transform:p(o)}),i&&this.output()},initCropBox:function(){var i=this.options,e=this.canvas,s=i.aspectRatio,o=Tt(i.autoCropArea)||.8,h={width:e.width,height:e.height};s&&(e.height*s>e.width?h.height=h.width/s:h.width=h.height*s),this.cropBox=h,this.limitCropBox(!0,!0),h.width=Xt(Yt(h.width,h.minWidth),h.maxWidth),h.height=Xt(Yt(h.height,h.minHeight),h.maxHeight),h.width=Yt(h.minWidth,h.width*o),h.height=Yt(h.minHeight,h.height*o),h.oldLeft=h.left=e.left+(e.width-h.width)/2,h.oldTop=h.top=e.top+(e.height-h.height)/2,this.initialCropBox=t.extend({},h)},constrainCropBox:function(t,i,e){var s=this.options,o=this.container;if(4===s.viewMode&&!b(t,i,e)){var h=B(e,s.aspectRatio||i.aspectRatio);t.width=h.width,t.maxWidth=t.width,t.height=h.height,t.maxHeight=t.height,t.left=(o.width-t.width)/2,t.maxLeft=t.left,t.minLeft=t.left,t.top=(o.height-t.height)/2,t.maxTop=t.top,t.minTop=t.top}this.$cropBox.css({width:t.width,height:t.height,left:t.left,top:t.top})},limitCropBox:function(t,i){var e,s,o,h,a=this.options,n=a.aspectRatio,r=this.container,p=r.width,l=r.height,c=this.canvas,d=this.cropBox,g=this.isLimited;t&&(e=Tt(a.minCropBoxWidth)||0,s=Tt(a.minCropBoxHeight)||0,e=Xt(e,p),s=Xt(s,l),o=Xt(p,g?c.width:p),h=Xt(l,g?c.height:l),n&&(e&&s?s*n>e?s=e/n:e=s*n:e?s=e/n:s&&(e=s*n),h*n>o?h=o/n:o=h*n),d.minWidth=Xt(e,o),d.minHeight=Xt(s,h),d.maxWidth=o,d.maxHeight=h),i&&(g?(d.minLeft=Yt(0,c.left),d.minTop=Yt(0,c.top),d.maxLeft=Xt(p,c.left+c.width)-d.width,d.maxTop=Xt(l,c.top+c.height)-d.height):(d.minLeft=0,d.minTop=0,d.maxLeft=p-d.width,d.maxTop=l-d.height))},renderCropBox:function(){var t=this.options,i=this.container,e=i.width,s=i.height,o=this.cropBox,h=this.canvas,a=this.image;(o.width>o.maxWidth||o.width<o.minWidth)&&(o.left=o.oldLeft),(o.height>o.maxHeight||o.height<o.minHeight)&&(o.top=o.oldTop),o.width=Xt(Yt(o.width,o.minWidth),o.maxWidth),o.height=Xt(Yt(o.height,o.minHeight),o.maxHeight),this.limitCropBox(!1,!0),o.oldLeft=o.left=Xt(Yt(o.left,o.minLeft),o.maxLeft),o.oldTop=o.top=Xt(Yt(o.top,o.minTop),o.maxTop),t.movable&&t.cropBoxMovable&&this.$face.data(dt,o.width===e&&o.height===s?yt:bt),this.constrainCropBox(o,h,a),this.isCropped&&this.isLimited&&this.limitCanvas(!0,!0),this.isDisabled||this.output()},output:function(){this.preview(),this.isCompleted&&this.trigger(ht,this.getData())},initPreview:function(){var i,e=n(this.crossOrigin),s=e?this.crossOriginUrl:this.url;this.$preview=t(this.options.preview),this.$clone2=i=t("<img"+e+' src="'+s+'">'),this.$viewBox.html(i),this.$preview.each(function(){var i=t(this);i.data(ct,{width:i.width(),height:i.height(),html:i.html()}),i.html("<img"+e+' src="'+s+'" style="display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;">')})},resetPreview:function(){this.$preview.each(function(){var i=t(this),e=i.data(ct);i.css({width:e.width,height:e.height}).html(e.html).removeData(ct)})},preview:function(){var i=this.image,e=this.canvas,s=this.cropBox,o=s.width,h=s.height,a=i.width,n=i.height,r=s.left-e.left-i.left,l=s.top-e.top-i.top;this.isCropped&&!this.isDisabled&&(this.$clone2.css({width:a,height:n,marginLeft:-r,marginTop:-l,transform:p(i)}),this.$preview.each(function(){var e=t(this),s=e.data(ct),c=s.width,d=s.height,g=c,f=d,u=1;o&&(u=c/o,f=h*u),h&&f>d&&(u=d/h,g=o*u,f=d),e.css({width:g,height:f}).find("img").css({width:a*u,height:n*u,marginLeft:-r*u,marginTop:-l*u,transform:p(i)})}))},bind:function(){var i=this.options,e=this.$element,s=this.$cropper;t.isFunction(i.cropstart)&&e.on(et,i.cropstart),t.isFunction(i.cropmove)&&e.on(st,i.cropmove),t.isFunction(i.cropend)&&e.on(ot,i.cropend),t.isFunction(i.crop)&&e.on(ht,i.crop),t.isFunction(i.zoom)&&e.on(at,i.zoom),s.on(_,t.proxy(this.cropStart,this)),i.zoomable&&i.zoomOnWheel&&s.on(Z,t.proxy(this.wheel,this)),i.toggleDragModeOnDblclick&&s.on(Q,t.proxy(this.dblclick,this)),M.on(q,this._cropMove=o(this.cropMove,this)).on(K,this._cropEnd=o(this.cropEnd,this)),i.responsive&&L.on(J,this._resize=o(this.resize,this))},unbind:function(){var i=this.options,e=this.$element,s=this.$cropper;t.isFunction(i.cropstart)&&e.off(et,i.cropstart),t.isFunction(i.cropmove)&&e.off(st,i.cropmove),t.isFunction(i.cropend)&&e.off(ot,i.cropend),t.isFunction(i.crop)&&e.off(ht,i.crop),t.isFunction(i.zoom)&&e.off(at,i.zoom),s.off(_,this.cropStart),i.zoomable&&i.zoomOnWheel&&s.off(Z,this.wheel),i.toggleDragModeOnDblclick&&s.off(Q,this.dblclick),M.off(q,this._cropMove).off(K,this._cropEnd),i.responsive&&L.off(J,this._resize)},resize:function(){var i,e,s,o=this.options.restore,h=this.$container,a=this.container,n=this.options;!this.isDisabled&&a&&(s=h.width()/a.width,1===s&&h.height()===a.height||(o&&4!==n.viewMode&&(i=this.getCanvasData(),e=this.getCropBoxData()),this.render(),o&&4!==n.viewMode&&(this.setCanvasData(t.each(i,function(t,e){i[t]=e*s})),this.setCropBoxData(t.each(e,function(t,i){e[t]=i*s})))))},dblclick:function(){this.isDisabled||(this.$dragBox.hasClass(j)?this.setDragMode(yt):this.setDragMode(Bt))},wheel:function(i){var e=i.originalEvent||i,s=Tt(this.options.wheelZoomRatio)||.1,o=1;this.isDisabled||(i.preventDefault(),this.wheeling||(this.wheeling=!0,setTimeout(t.proxy(function(){this.wheeling=!1},this),50),e.deltaY?o=e.deltaY>0?1:-1:e.wheelDelta?o=-e.wheelDelta/120:e.detail&&(o=e.detail>0?1:-1),this.zoom(-o*s,i)))},cropStart:function(i){var e,s,o=this.options,h=i.originalEvent,a=h&&h.touches,n=i;if(!this.isDisabled){if(a){if(e=a.length,e>1){if(!o.zoomable||!o.zoomOnTouch||2!==e)return;n=a[1],this.startX2=n.pageX,this.startY2=n.pageY,s=Dt}n=a[0]}if(s=s||t(n.target).data(dt),nt.test(s)){if(this.trigger(et,{originalEvent:h,action:s}).isDefaultPrevented())return;s!==$t&&i.preventDefault(),this.action=s,this.cropping=!1,this.startX=n.pageX||h&&h.pageX,this.startY=n.pageY||h&&h.pageY,s===Bt&&(this.cropping=!0,this.$dragBox.addClass(P))}}},cropMove:function(t){var i,e=this.options,s=t.originalEvent,o=s&&s.touches,h=t,a=this.action;if(!this.isDisabled){if(o){if(i=o.length,i>1){if(!e.zoomable||!e.zoomOnTouch||2!==i)return;h=o[1],this.endX2=h.pageX,this.endY2=h.pageY}h=o[0]}if(a){if(this.trigger(st,{originalEvent:s,action:a}).isDefaultPrevented())return;if(a===$t)return;t.preventDefault(),this.endX=h.pageX||s&&s.pageX,this.endY=h.pageY||s&&s.pageY,this.change(h.shiftKey,a===Dt?t:null)}}},cropEnd:function(t){var i=t.originalEvent,e=this.action;this.isDisabled||e&&(t.preventDefault(),this.cropping&&(this.cropping=!1,this.$dragBox.toggleClass(P,this.isCropped&&this.options.modal)),this.action="",this.trigger(ot,{originalEvent:i,action:e}))},change:function(t,i){var e,s,o=this.options,h=o.aspectRatio,a=this.action,n=this.container,r=this.canvas,p=this.image,l=this.cropBox,c=l.width,d=l.height,g=l.left,f=l.top,u=g+c,m=f+d,v=0,w=0,x=n.width,C=n.height,B=!0;switch(!h&&t&&(h=c&&d?c/d:1),this.isLimited&&(v=l.minLeft,w=l.minTop,x=v+Xt(n.width,r.left+r.width),C=w+Xt(n.height,r.top+r.height)),s={x:this.endX-this.startX,y:this.endY-this.startY},h&&(s.X=s.y*h,s.Y=s.x/h),a){case bt:g+=s.x,f+=s.y;break;case gt:if(s.x>=0&&(u>=x||h&&(f<=w||m>=C))){B=!1;break}c+=s.x,h&&(d=c/h,f-=s.Y/2),c<0&&(a=ft,c=0);break;case mt:if(s.y<=0&&(f<=w||h&&(g<=v||u>=x))){B=!1;break}d-=s.y,f+=s.y,h&&(c=d*h,g+=s.X/2),d<0&&(a=ut,d=0);break;case ft:if(s.x<=0&&(g<=v||h&&(f<=w||m>=C))){B=!1;break}c-=s.x,g+=s.x,h&&(d=c/h,f+=s.Y/2),c<0&&(a=gt,c=0);break;case ut:if(s.y>=0&&(m>=C||h&&(g<=v||u>=x))){B=!1;break}d+=s.y,h&&(c=d*h,g-=s.X/2),d<0&&(a=mt,d=0);break;case xt:if(h){if(s.y<=0&&(f<=w||u>=x)){B=!1;break}d-=s.y,f+=s.y,c=d*h}else s.x>=0?u<x?c+=s.x:s.y<=0&&f<=w&&(B=!1):c+=s.x,s.y<=0?f>w&&(d-=s.y,f+=s.y):(d-=s.y,f+=s.y);c<0&&d<0?(a=wt,d=0,c=0):c<0?(a=Ct,c=0):d<0&&(a=vt,d=0);break;case Ct:if(h){if(s.y<=0&&(f<=w||g<=v)){B=!1;break}d-=s.y,f+=s.y,c=d*h,g+=s.X}else s.x<=0?g>v?(c-=s.x,g+=s.x):s.y<=0&&f<=w&&(B=!1):(c-=s.x,g+=s.x),s.y<=0?f>w&&(d-=s.y,f+=s.y):(d-=s.y,f+=s.y);c<0&&d<0?(a=vt,d=0,c=0):c<0?(a=xt,c=0):d<0&&(a=wt,d=0);break;case wt:if(h){if(s.x<=0&&(g<=v||m>=C)){B=!1;break}c-=s.x,g+=s.x,d=c/h}else s.x<=0?g>v?(c-=s.x,g+=s.x):s.y>=0&&m>=C&&(B=!1):(c-=s.x,g+=s.x),s.y>=0?m<C&&(d+=s.y):d+=s.y;c<0&&d<0?(a=xt,d=0,c=0):c<0?(a=vt,c=0):d<0&&(a=Ct,d=0);break;case vt:if(h){if(s.x>=0&&(u>=x||m>=C)){B=!1;break}c+=s.x,d=c/h}else s.x>=0?u<x?c+=s.x:s.y>=0&&m>=C&&(B=!1):c+=s.x,s.y>=0?m<C&&(d+=s.y):d+=s.y;c<0&&d<0?(a=Ct,d=0,c=0):c<0?(a=wt,c=0):d<0&&(a=xt,d=0);break;case yt:this.move(s.x,s.y),B=!1;break;case Dt:this.zoom(function(t,i,e,s){var o=Ht(t*t+i*i),h=Ht(e*e+s*s);return(h-o)/o}(Wt(this.startX-this.startX2),Wt(this.startY-this.startY2),Wt(this.endX-this.endX2),Wt(this.endY-this.endY2)),i),this.startX2=this.endX2,this.startY2=this.endY2,B=!1;break;case Bt:if(!s.x||!s.y){B=!1;break}e=this.$cropper.offset(),g=this.startX-e.left,f=this.startY-e.top,c=l.minWidth,d=l.minHeight,s.x>0?a=s.y>0?vt:xt:s.x<0&&(g-=c,a=s.y>0?wt:Ct),s.y<0&&(f-=d),this.isCropped||(this.$cropBox.removeClass(U),this.isCropped=!0,this.isLimited&&this.limitCropBox(!0,!0))}var y={top:f,left:g,width:c,height:d,maxWidth:x,maxHeight:C};4!==o.viewMode||b(y,r,p)||(y.top=l.top,b(y,r,p)||(y.top=f,y.left=l.left,B=b(y,r,p))),B&&(l.width=y.width,l.height=y.height,l.left=y.left,l.top=y.top,l.maxWidth=x,l.maxHeight=C,this.action=a,this.renderCropBox()),this.startX=this.endX,this.startY=this.endY},crop:function(){this.isBuilt&&!this.isDisabled&&(this.isCropped||(this.isCropped=!0,this.limitCropBox(!0,!0),this.options.modal&&this.$dragBox.addClass(P),this.$cropBox.removeClass(U)),this.setCropBoxData(this.initialCropBox))},reset:function(){this.isBuilt&&!this.isDisabled&&(this.image=t.extend({},this.initialImage),this.canvas=t.extend({},this.initialCanvas),this.cropBox=t.extend({},this.initialCropBox),this.renderCanvas(),this.isCropped&&this.renderCropBox())},clear:function(){this.isCropped&&!this.isDisabled&&(t.extend(this.cropBox,{left:0,top:0,width:0,height:0}),this.isCropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),this.$dragBox.removeClass(P),this.$cropBox.addClass(U))},replace:function(t,i){!this.isDisabled&&t&&(this.isImg&&this.$element.attr("src",t),i?(this.url=t,this.$clone.attr("src",t),this.isBuilt&&this.$preview.find("img").add(this.$clone2).attr("src",t)):(this.isImg&&(this.isReplaced=!0),this.options.data=null,this.load(t)))},enable:function(){this.isBuilt&&(this.isDisabled=!1,this.$cropper.removeClass(S))},disable:function(){this.isBuilt&&(this.isDisabled=!0,this.$cropper.addClass(S))},destroy:function(){var t=this.$element;this.isLoaded?(this.isImg&&this.isReplaced&&t.attr("src",this.originalUrl),this.unbuild(),t.removeClass(U)):this.isImg?t.off(V,this.start):this.$clone&&this.$clone.remove(),t.removeData(H)},move:function(t,i){var s=this.canvas;this.moveTo(e(t)?t:s.left+Tt(t),e(i)?i:s.top+Tt(i))},moveTo:function(t,s){var o=this.canvas,h=!1;e(s)&&(s=t),t=Tt(t),s=Tt(s),this.isBuilt&&!this.isDisabled&&this.options.movable&&(i(t)&&(o.left=t,h=!0),i(s)&&(o.top=s,h=!0),h&&this.renderCanvas(!0))},zoom:function(t,i){var e=this.canvas;t=Tt(t),t=t<0?1/(1-t):1+t,this.zoomTo(e.width*t/e.naturalWidth,i)},zoomTo:function(t,i){var e,s,o,h,a,n=this.options,r=this.canvas,p=r.width,l=r.height,c=r.naturalWidth,g=r.naturalHeight;if(t=Tt(t),t>=0&&this.isBuilt&&!this.isDisabled&&n.zoomable){if(s=c*t,o=g*t,i&&(e=i.originalEvent),this.trigger(at,{originalEvent:e,oldRatio:p/c,ratio:s/c}).isDefaultPrevented())return;e?(h=this.$cropper.offset(),a=e.touches?d(e.touches):{pageX:i.pageX||e.pageX||0,pageY:i.pageY||e.pageY||0},r.left-=(s-p)*((a.pageX-h.left-r.left)/p),r.top-=(o-l)*((a.pageY-h.top-r.top)/l)):(r.left-=(s-p)/2,r.top-=(o-l)/2),r.width=s,r.height=o,this.renderCanvas(!0)}},rotate:function(t){this.rotateTo((this.image.rotate||0)+Tt(t))},rotateTo:function(t){t=Tt(t),i(t)&&this.isBuilt&&!this.isDisabled&&this.options.rotatable&&(this.image.rotate=t%360,this.isRotated=!0,this.renderCanvas(!0))},scale:function(t,s){var o=this.image,h=!1;e(s)&&(s=t),t=Tt(t),s=Tt(s),this.isBuilt&&!this.isDisabled&&this.options.scalable&&(i(t)&&(o.scaleX=t,h=!0),i(s)&&(o.scaleY=s,h=!0),h&&this.renderImage(!0))},scaleX:function(t){var e=this.image.scaleY;this.scale(t,i(e)?e:1)},scaleY:function(t){var e=this.image.scaleX;this.scale(i(e)?e:1,t)},getData:function(i){var e,s,o=this.options,h=this.image,a=this.canvas,n=this.cropBox;return this.isBuilt&&this.isCropped?(s={x:n.left-a.left,y:n.top-a.top,width:n.width,height:n.height},e=h.width/h.naturalWidth,t.each(s,function(t,o){o/=e,s[t]=i?zt(o):o})):s={x:0,y:0,width:0,height:0},o.rotatable&&(s.rotate=h.rotate||0),o.scalable&&(s.scaleX=h.scaleX||1,s.scaleY=h.scaleY||1),s},setData:function(e){var s,o,h,a=this.options,n=this.image,r=this.canvas,p={};t.isFunction(e)&&(e=e.call(this.element)),this.isBuilt&&!this.isDisabled&&t.isPlainObject(e)&&(a.rotatable&&i(e.rotate)&&e.rotate!==n.rotate&&(n.rotate=e.rotate,this.isRotated=s=!0),a.scalable&&(i(e.scaleX)&&e.scaleX!==n.scaleX&&(n.scaleX=e.scaleX,o=!0),i(e.scaleY)&&e.scaleY!==n.scaleY&&(n.scaleY=e.scaleY,o=!0)),s?this.renderCanvas():o&&this.renderImage(),h=n.width/n.naturalWidth,i(e.x)&&(p.left=e.x*h+r.left),i(e.y)&&(p.top=e.y*h+r.top),i(e.width)&&(p.width=e.width*h),i(e.height)&&(p.height=e.height*h),this.setCropBoxData(p))},getContainerData:function(){return this.isBuilt?this.container:{}},getImageData:function(){return this.isLoaded?this.image:{}},getCanvasData:function(){var i=this.canvas,e={};return this.isBuilt&&t.each(["left","top","width","height","naturalWidth","naturalHeight"],function(t,s){e[s]=i[s]}),e},setCanvasData:function(e){var s=this.canvas,o=s.aspectRatio;t.isFunction(e)&&(e=e.call(this.$element)),this.isBuilt&&!this.isDisabled&&t.isPlainObject(e)&&(i(e.left)&&(s.left=e.left),i(e.top)&&(s.top=e.top),i(e.width)?(s.width=e.width,s.height=e.width/o):i(e.height)&&(s.height=e.height,s.width=e.height*o),this.renderCanvas(!0))},getCropBoxData:function(){var t,i=this.cropBox;return this.isBuilt&&this.isCropped&&(t={left:i.left,top:i.top,width:i.width,height:i.height}),t||{}},setCropBoxData:function(e){var s,o,h=this.cropBox,a=this.options.aspectRatio;t.isFunction(e)&&(e=e.call(this.$element)),this.isBuilt&&this.isCropped&&!this.isDisabled&&t.isPlainObject(e)&&(i(e.left)&&(h.left=e.left),i(e.top)&&(h.top=e.top),i(e.width)&&(s=!0,h.width=e.width),i(e.height)&&(o=!0,h.height=e.height),a&&(s?h.height=h.width/a:o&&(h.width=h.height*a)),this.renderCropBox())},getCroppedCanvas:function(i){var e,s,o,h,a,n,r,p,l,d=I*z,g=O*z,f=!1,u=this.getData();if(this.isBuilt&&Lt){if(p=c(this.$clone[0],this.image,u),!this.isCropped)return p;if(o=a=p.width,h=n=p.height,t.isPlainObject(i)||(i={}),t.isPlainObject(i)&&(o=i.imageWidth||o,h=i.imageHeight||h,a=i.width||a,n=i.height||n,f=i.tiled,d=i.margin||I*z,g=i.border||O*z),e=Ot(a),s=Ot(n),r=t("<canvas>")[0],f===!0){var m=D({width:e,height:s},{width:o,height:h},g,d);if(m.canvasRotated===!0){var v=e;e=s,s=v}}if(r.width=e,r.height=s,l=r.getContext("2d"),i.fillColor&&(l.fillStyle=i.fillColor,l.fillRect(0,0,e,s)),f===!0)for(var w=d,x=(e-m.horizontal*o-(m.horizontal-1)*w)/2,C=(s-m.vertical*h-(m.vertical-1)*w)/2,b=0;b<m.horizontal;b++)for(var B=0;B<m.vertical;B++){var y=x+w*b+o*b,$=C+w*B+h*B;l.drawImage(p,y,$,o,h)}else{var L=(e-o)/2,M=(s-h)/2,T=o,X=h;l.drawImage(p,L,M,T,X)}return r}},setAspectRatio:function(t){var i=this.options;this.isDisabled||e(t)||(i.aspectRatio=Yt(0,t)||NaN,this.isBuilt&&(this.initCropBox(),this.isCropped&&this.renderCropBox()))},setDragMode:function(t){var i,e,s=this.options;this.isLoaded&&!this.isDisabled&&(i=t===Bt,e=s.movable&&t===yt,t=i||e?t:$t,this.$dragBox.data(dt,t).toggleClass(j,i).toggleClass(F,e),s.cropBoxMovable||this.$face.data(dt,t).toggleClass(j,i).toggleClass(F,e))}},$.DEFAULTS={viewMode:0,dragMode:"crop",aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,build:null,built:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},$.setDefaults=function(i){t.extend($.DEFAULTS,i)},$.TEMPLATE='<div class="cropper-container"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-action="e"></span><span class="cropper-line line-n" data-action="n"></span><span class="cropper-line line-w" data-action="w"></span><span class="cropper-line line-s" data-action="s"></span><span class="cropper-point point-e" data-action="e"></span><span class="cropper-point point-n" data-action="n"></span><span class="cropper-point point-w" data-action="w"></span><span class="cropper-point point-s" data-action="s"></span><span class="cropper-point point-ne" data-action="ne"></span><span class="cropper-point point-nw" data-action="nw"></span><span class="cropper-point point-sw" data-action="sw"></span><span class="cropper-point point-se" data-action="se"></span></div></div>',$.other=t.fn.cropper,t.fn.cropper=function(i){var o,h=s(arguments,1);return this.each(function(){var e,s,a=t(this),n=a.data(H);if(!n){if(/destroy/.test(i))return;e=t.extend({},a.data(),t.isPlainObject(i)&&i),a.data(H,n=new $(this,e))}"string"==typeof i&&t.isFunction(s=n[i])&&(o=s.apply(n,h))}),e(o)?this:o},t.fn.cropper.Constructor=$,t.fn.cropper.setDefaults=$.setDefaults,t.fn.cropper.noConflict=function(){return t.fn.cropper=$.other,this}});